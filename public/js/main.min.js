/*! I am Ugly! */

!function(a){"use strict";a.ready=function(){var b,c,d=[],e=function(b){for(var c=0;c<b.length;c++)if("object"==typeof b[c]){var d=a("#"+b[c].formID),e=d.parent().find("select"),f=e.find('option[selected="selected"]'),g=d.parent().find("iframe");null!==f&&f.removeAttr("selected"),a("<option>"+b[c].siteName+"</option>").attr({selected:"select",value:b[c].url}).appendTo(e),"object"!=typeof b[c+1]&&g.attr("src",b[c].url)}},f=function(d){var e=d.currentTarget;if(b=a(".active-tab"),b.removeClass("active-tab"),a(e).addClass("active-tab"),Modernizr.localstorage)if(c=localStorage.getItem("savedReports"),null!==c){var f=JSON.parse(c),g=f[f.length-1],h=f.length-1;"string"==typeof g&&f.splice(h,1,e.id),localStorage.savedReports=JSON.stringify(f)}else{var i=[e.id];localStorage.savedReports=JSON.stringify(i)}},g=function(b){var c=b.target,d=a(".active-item"),e=a(c).parent();null!==d&&d.removeClass("active-item"),a(c).addClass("active-item"),e.parent().hasClass("active-menu")||e.parent().addClass("active-menu")},h=function(b){var c=b.target,d=a(c).parent(),e=a(".action-list");e.each(function(){a(this).removeClass("active-menu")}),"focus"===b.type&&d.parent().addClass("active-menu")},i=function(b){var c;a(b.currentTarget).hasClass("app-button")?(c=a(b.currentTarget).parent().find(".reports"),c.toggleClass("active-window")):(c=a(b.currentTarget).parent(),c.toggleClass("active-window"),a(b.currentTarget).hasClass("submit_btn")&&j(b))},j=function(b){var c,d=a(b.currentTarget).parent(),e=d.parent(),f=e.find("iframe");c=e.find(":selected"),f.attr("src",c[0].value)},k=function(a){a.preventDefault(),"click"===a.type?i(a):"keypress"===a.type&&13===a.keyCode&&i(a)},l=function(b){var c,d=a(b.currentTarget).parent().find("iframe"),e=d.attr("src");c=window.open(e,"_blank"),c.focus()},m=function(a){"click"===a.type?l(a):"keypress"===a.type&&13===a.keyCode&&l(a)},n=function(b){var c,e=b.target,f=a(e).children().val(),g=a(".notifications"),h=a(".js-site-name"),i=[],j=new RegExp("("+f+"(([a-z]|\\d){1,2})?)","i");console.log("SearchedInput: "+f),b.preventDefault(),h.each(function(b){""!==a(this).val()&&(console.log("This val: "+a(this).val()),i.push(a(this).val()),console.log("index: "+b),console.log("sitesNames: "+i[0]))}),0===i.length&&g.html('<p>The searched report "'+f+'" is not found.</p>');for(var k=0;k<i.length;k++)if(c=i[k].match(j),console.log("match: "+c),c[0].toLowerCase()===i[k].toLowerCase()){g.html('<p>Report "'+f+'" is found.</p>');var l,m,n=UTILS.qs("#"+d[k].formID).parentNode,o=n.parentNode,p=UTILS.qs(".active-tab"),q=n.querySelector("iframe");UTILS.removeClass(p,"active-tab"),UTILS.addClass(o,"active-tab"),l=n.querySelector('option[selected="selected"]'),l.removeAttribute("selected"),m=n.querySelector('option[value="'+d[k].url+'"]'),m.setAttribute("selected","selected"),q.setAttribute("src",m.value)}else g.html('<p>The searched report "'+f+'" is not found.</p>')},o=function(b,e){var f,g,h,i,j,k=a(b).find(".report-row"),l=k.eq(0).find(".js-site-name"),m=k.eq(0).find(".js-site-url"),n=a(b).find(".system-message"),o=a(".wrong"),q=localStorage.savedReports;for(d=[],o.each(function(){a(this).removeClass("wrong")}),n.html(""),""===l.val()&&""===m.val()&&!q||q.length<=8?(n.html("Please, write site name and URL before saving."),l.focus()):""===l.val()&&""===m.val()&&q.length>8&&(a(b).toggleClass("active-window"),a(b).prev().empty(),localStorage.removeItem(c),a(b).next().find("iframe").removeAttr("src")),f=0;f<k.length;f++)g=k.eq(f),h=g.find(".js-site-name"),i=g.find(".js-site-url"),(""!==h.val()||""!==i.val())&&("http"!==i.val().substring(0,4)&&i.val("http://"+i.val()),""!==h.val()&&""===i.val()?(n.html("Please, enter the site URL!"),i.addClass("wrong"),i.focus()):""===h.value&&""!==i.value?(n.html("Please, write the title for entered URL!"),h.addClass("wrong"),h.focus()):""!==h.val()&&""!==i.val()&&(j=p(i.val()),j?r(h.val(),i.val(),e,b,g[0]):(n.html("Please, enter valid URL!"),i.addClass("wrong"),i.focus())))},p=function(a){var b=/http(s)?:\/\/w{0,3}.+\.\w{2,4}(.+)?/g;return b.test(a)},q=function(a){var b=a.target.parentNode;a.preventDefault(),o(b,a)},r=function(b,c,f,g,h){var i=a(g).parent().find("select"),j=i.find(":selected"),l=a(g).parent(),m=l.parent().attr("id"),n=h.id,o={};i.empty(),o={siteName:b,url:c,fieldID:n,formID:g.id},e(d),d.push(o),d.push(m),Modernizr.localstorage&&(localStorage.savedReports=JSON.stringify(d)),j&&j.removeAttr("selected"),a("<option/>",{value:c,selected:"selected",text:b}).appendTo(i),k(f)},s=function(b){var c=b.target,d=a(c).parent().parent();27===b.keyCode&&d.removeClass("active-window")},t=function(){var d;c=localStorage.getItem("savedReports"),console.log("Init"),console.log(c),console.log("Modernizr.input.placeholder: "+Modernizr.input.placeholder);var i=a(".js-site-name"),l=a(".js-site-url"),o=a("#search"),p=a("#search > input");if(o.on("submit",n),!Modernizr.input.placeholder){var r=function(a){var b=a.target;("Site name"===b.value||"Site URL"===b.value||"Search"===b.value)&&(b.value="")};p.val("Search"),p.on("focus",r),i.each(function(a){i.eq(a).val("Site name"),l.eq(a).val("Site URL"),i.eq(a).on("focus",r),l.eq(a).on("focus",r)})}if(Modernizr.localstorage&&(c=localStorage.getItem("savedReports"))){var t,u,v,w,x=JSON.parse(c);for(d=0;d<x.length;d++)x[d].fieldID&&(t=x[d].fieldID,u=a("#"+t),v=u.find(".js-site-name"),w=u.find(".js-site-url"),w.val(x[d].url),v.val(x[d].siteName));if("string"==typeof x[x.length-1]){var y;b=a(".active-tab"),b.removeClass("active-tab"),y=a("#"+x[x.length-1]),y.addClass("active-tab")}var z=[];a(x).each(function(a){"object"==typeof x[a]&&z.push(x[a])}),e(z)}var A=a(".action-list a");A.each(function(a){A.eq(a).on("focus",g)});var B=a(".action-list li:first-child a");B.each(function(a){B.eq(a).on("focus",h)});var C=a(".last-menu-item");C.on("blur",h);var D=a(".tab");D.each(function(a){D.eq(a).on("click focus",f)});var E=a(".new-tab-btn");E.each(function(a){E.eq(a).on("click keypress",m)});var F=a(".reports-btn");F.each(function(a){F.eq(a).on("click keypress",k)});var G=a(".cancel-btn");G.each(function(a){G.eq(a).on("click keypress",k)});var H=a(".submit_btn");H.each(function(a){H.eq(a).on("click keypress",q)});var I=a("select");I.each(function(a){I.eq(a).on("change",j)});var J=a(".reports input");J.each(function(a){J.eq(a).on("keyup",s)})};t()}}(jQuery);
//# sourceMappingURL=main.min.js.map