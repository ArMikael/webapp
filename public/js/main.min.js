/*! I am Ugly! */

!function(a){"use strict";a.ready=function(){var b,c,d=[],e=function(b){for(var c=0;c<b.length;c++)if("object"==typeof b[c]){var d=a("#"+b[c].formID),e=d.parent().find("select"),f=e.find('option[selected="selected"]'),g=d.parent().find("iframe");null!==f&&f.removeAttr("selected"),a("<option>"+b[c].siteName+"</option>").attr({selected:"select",value:b[c].url}).appendTo(e),"object"!=typeof b[c+1]&&g.attr("src",b[c].url)}},f=function(d){var e=d.currentTarget;if(b=a(".active-tab"),b.removeClass("active-tab"),a(e).addClass("active-tab"),Modernizr.localstorage)if(c=localStorage.getItem("savedReports"),null!==c){var f=JSON.parse(c),g=f[f.length-1],h=f.length-1;"string"==typeof g&&f.splice(h,1,e.id),localStorage.savedReports=JSON.stringify(f)}else{var i=[e.id];localStorage.savedReports=JSON.stringify(i)}},g=function(b){var c=b.target,d=a(".active-item"),e=a(c).parent();null!==d&&d.removeClass("active-item"),a(c).addClass("active-item"),e.parent().hasClass("active-menu")||e.parent().addClass("active-menu")},h=function(b){var c=b.target,d=a(c).parent(),e=a(".action-list");e.each(function(){a(this).removeClass("active-menu")}),"focus"===b.type&&d.parent().addClass("active-menu")},i=function(b){var c;a(b.currentTarget).hasClass("app-button")?(c=a(b.currentTarget).parent().find(".reports"),c.toggleClass("active-window")):(c=a(b.currentTarget).parent(),c.toggleClass("active-window"),a(b.currentTarget).hasClass("submit_btn")&&j(b))},j=function(b){var c,d,e,f=a(b.currentTarget).parent(),g=f.parent(),h=g.find("iframe"),i=g.find('option[selected="selected"]');"change"===b.type&&(null!==i&&i.removeAttr("selected"),c=b.currentTarget.selectedIndex,d=a(b.currentTarget).options[c],d.attr("selected","selected")),e=g.find('option[selected="selected"]'),h.attr("src",e[0].value)},k=function(a){a.preventDefault(),"click"===a.type?i(a):"keypress"===a.type&&13===a.keyCode&&i(a)},l=function(b){var c,d=a(b.currentTarget).parent().find("iframe"),e=d.attr("src");c=window.open(e,"_blank"),c.focus()},m=function(a){"click"===a.type?l(a):"keypress"===a.type&&13===a.keyCode&&l(a)},n=function(b){var c,e=b.target,f=a(e).children().val(),g=a(".notifications"),h=a(".js-site-name"),i=[],j=new RegExp("("+f+"(([a-z]|\\d){1,2})?)","i");console.log("SearchedInput: "+f),b.preventDefault(),h.each(function(b){""!==a(this).val()&&(console.log("This val: "+a(this).val()),i.push(a(this).val()),console.log("index: "+b),console.log("sitesNames: "+i[0]))}),0===i.length&&g.html('<p>The searched report "'+f+'" is not found.</p>');for(var k=0;k<i.length;k++)if(c=i[k].match(j),console.log("match: "+c),c[0].toLowerCase()===i[k].toLowerCase()){g.html('<p>Report "'+f+'" is found.</p>');var l,m,n=UTILS.qs("#"+d[k].formID).parentNode,o=n.parentNode,p=UTILS.qs(".active-tab"),q=n.querySelector("iframe");UTILS.removeClass(p,"active-tab"),UTILS.addClass(o,"active-tab"),l=n.querySelector('option[selected="selected"]'),l.removeAttribute("selected"),m=n.querySelector('option[value="'+d[k].url+'"]'),m.setAttribute("selected","selected"),q.setAttribute("src",m.value)}else g.html('<p>The searched report "'+f+'" is not found.</p>')},o=function(b,e){var f,g,h,i,j,k=a(b).find(".report-row"),l=k.eq(0).find(".js-site-name"),m=k.eq(0).find(".js-site-url"),n=a(b).find(".system-message"),o=a(".wrong"),q=localStorage.savedReports;for(d=[],o.each(function(){a(this).removeClass("wrong")}),n.html(""),""===l.val()&&""===m.val()&&!q||q.length<=8?(n.html("Please, write site name and URL before saving."),l.focus()):""===l.val()&&""===m.val()&&q.length>8&&(a(b).toggleClass("active-window"),a(b).prev().empty(),localStorage.removeItem(c),a(b).next().find("iframe").removeAttr("src")),f=0;f<k.length;f++)g=k.eq(f),h=g.find(".js-site-name"),i=g.find(".js-site-url"),(""!==h.val()||""!==i.val())&&("http"!==i.val().substring(0,4)&&i.val("http://"+i.val()),""!==h.val()&&""===i.val()?(n.html("Please, enter the site URL!"),i.addClass("wrong"),i.focus()):""===h.value&&""!==i.value?(n.html("Please, write the title for entered URL!"),h.addClass("wrong"),h.focus()):""!==h.val()&&""!==i.val()&&(j=p(i.val()),j?r(h.val(),i.val(),e,b,g):(n.html("Please, enter valid URL!"),i.addClass("wrong"),i.focus())))},p=function(a){var b=/http(s)?:\/\/w{0,3}.+\.\w{2,4}(.+)?/g;return b.test(a)},q=function(a){var b=a.target.parentNode;a.preventDefault(),o(b,a)},r=function(a,b,c,f,g){var h,i=f.parentNode.querySelector("select"),j=i.querySelector('option[selected="selected"]'),l=f.parentNode,m=l.parentNode.id,n=g.id,o={};i.innerHTML="",o={siteName:a,url:b,fieldID:n,formID:f.id},e(d),d.push(o),d.push(m),Modernizr.localstorage&&(localStorage.savedReports=JSON.stringify(d)),h=document.createElement("option"),h.value=b,j&&j.removeAttribute("selected"),h.setAttribute("selected","selected"),h.innerHTML=a,i.appendChild(h),k(c)},s=function(a){var b=a.target,c=b.parentNode,d=c.parentNode;27===a.keyCode&&UTILS.removeClass(d,"active-window")},t=function(){var d;c=localStorage.getItem("savedReports"),console.log("Init"),console.log(c),console.log("Modernizr.input.placeholder: "+Modernizr.input.placeholder);var i=a(".js-site-name"),l=a(".js-site-url"),o=a("#search"),p=a("#search > input");if(o.on("submit",n),!Modernizr.input.placeholder){var r=function(a){var b=a.target;("Site name"===b.value||"Site URL"===b.value||"Search"===b.value)&&(b.value="")};for(p.val("Search"),p.on("focus",r),d=0;d<i.length;d++)i.eq(d).val("Site name"),l.eq(d).val("Site URL"),i.eq(d).on("focus",r),l.eq(d).on("focus",r)}if(Modernizr.localstorage&&(c=localStorage.getItem("savedReports"))){var t,u,v,w,x=JSON.parse(c);for(d=0;d<x.length;d++)x[d].fieldID&&(t=x[d].fieldID,u=UTILS.qs("#"+t),v=u.querySelector(".js-site-name"),w=u.querySelector(".js-site-url"),w.value=x[d].url,v.value=x[d].siteName);if("string"==typeof x[x.length-1]){var y;b=a(".active-tab"),b.removeClass("active-tab"),y=a("#"+x[x.length-1]),y.addClass("active-tab")}var z=[];for(d=0;d<x.length;d++)"object"==typeof x[d]&&z.push(x[d]);e(z)}var A=UTILS.qsa(".action-list a");for(d=0;d<A.length;d++)UTILS.addEvent(A[d],"focus",g);var B=UTILS.qsa(".action-list li:first-child a");for(d=0;d<B.length;d++)UTILS.addEvent(B[d],"focus",h);var C=UTILS.qs(".last-menu-item");UTILS.addEvent(C,"blur",h);var D=UTILS.qsa(".tab");for(d=0;d<D.length;d++)UTILS.addEvent(D[d],"click focus",f);var E=UTILS.qsa(".new-tab-btn");for(d=0;d<E.length;d++)UTILS.addEvent(E[d],"click keypress",m);var F=UTILS.qsa(".reports-btn");for(d=0;d<F.length;d++)UTILS.addEvent(F[d],"click keypress",k);var G=UTILS.qsa(".cancel-btn");for(d=0;d<G.length;d++)UTILS.addEvent(G[d],"click keypress",k);var H=UTILS.qsa(".submit_btn");for(d=0;d<H.length;d++)UTILS.addEvent(H[d],"click",q);var I=UTILS.qsa("select");for(d=0;d<I.length;d++)UTILS.addEvent(I[d],"change",j);var J=UTILS.qsa(".reports input");for(d=0;d<J.length;d++)UTILS.addEvent(J[d],"keyup",s)};t()}}(jQuery);
//# sourceMappingURL=main.min.js.map